





<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://assets-cdn.github.com">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-/yZA7MGD9acBi5MmgjnivwjGeiNsmimsI/bhLlK7akrRuw+hMxNpJoQEMO9Zt0Nq6ZRu1m1NGV6r95Ib0zx7Qw==" rel="stylesheet" href="https://assets-cdn.github.com/assets/frameworks-1ca00d32d1a8adc78ae7bb6677410eb1.css" />
  <link crossorigin="anonymous" media="all" integrity="sha512-pHF1luoMSUFxvz63bW3jEbbifYl/pruHUw+kljThAPi2g0nhgMdvWj4bQRh4O8MYp9NR60XYcylaLXmYA8YXSw==" rel="stylesheet" href="https://assets-cdn.github.com/assets/github-5043b3d96d50b119b971c2cdde4e0a62.css" />
  
  
  <link crossorigin="anonymous" media="all" integrity="sha512-yiJlaqOzeTU+S1E7OWf1xHkAosW1l4Lum0URPcPeQqKjKdZuSb9JoS5h1Dn8vs5rmdGshJ8pTr/FWwGKHlr1SQ==" rel="stylesheet" href="https://assets-cdn.github.com/assets/site-f84f81f77b3e1a4462036783c13c150d.css" />
  

  <meta name="viewport" content="width=device-width">
  
  <title>foxx.github.io/2012-10-26-access-virus-ti-firmware-reverse.markdown at master · foxx/foxx.github.io · GitHub</title>
    <meta name="description" content="Contribute to foxx/foxx.github.io development by creating an account on GitHub.">
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    
    <meta property="og:image" content="https://avatars3.githubusercontent.com/u/651797?s=400&amp;v=4" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="foxx/foxx.github.io" /><meta property="og:url" content="https://github.com/foxx/foxx.github.io" /><meta property="og:description" content="Contribute to foxx/foxx.github.io development by creating an account on GitHub." />

  <link rel="assets" href="https://assets-cdn.github.com/">
  
  <meta name="pjax-timeout" content="1000">
  
  <meta name="request-id" content="C36F:4C89:2BBC5A8:40A3D9D:5BA6AC4E" data-pjax-transient>


  

  <meta name="selected-link" value="repo_source" data-pjax-transient>

      <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
    <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">

  <meta name="octolytics-host" content="collector.githubapp.com" /><meta name="octolytics-app-id" content="github" /><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event" /><meta name="octolytics-dimension-request_id" content="C36F:4C89:2BBC5A8:40A3D9D:5BA6AC4E" /><meta name="octolytics-dimension-region_edge" content="sea" /><meta name="octolytics-dimension-region_render" content="iad" />
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true" />



    <meta name="google-analytics" content="UA-3769691-2">


<meta class="js-ga-set" name="dimension1" content="Logged Out">



  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="MGZkN2E1ZjY4ODU5ODZmZDliZjBiMzI5MGQ3MzJhZTUxMTk0MzEzM2MzNWIzODUyZjExMGI5MTBhMzM3NjEwNnx7InJlbW90ZV9hZGRyZXNzIjoiMTIxLjk5Ljk3LjIyNCIsInJlcXVlc3RfaWQiOiJDMzZGOjRDODk6MkJCQzVBODo0MEEzRDlEOjVCQTZBQzRFIiwidGltZXN0YW1wIjoxNTM3NjQ5NzUyLCJob3N0IjoiZ2l0aHViLmNvbSJ9">

    <meta name="enabled-features" content="DASHBOARD_V2_LAYOUT_OPT_IN,EXPLORE_DISCOVER_REPOSITORIES,UNIVERSE_BANNER,MARKETPLACE_PLAN_RESTRICTION_EDITOR,QUOTE_MARKDOWN">

  <meta name="html-safe-nonce" content="4f3f2e8de55a11a0645e90d07258f2bd982ad4e5">

  <meta http-equiv="x-pjax-version" content="537b4dd9d2be0dc6070df345bc4f538d">
  

      <link href="https://github.com/foxx/foxx.github.io/commits/master.atom" rel="alternate" title="Recent Commits to foxx.github.io:master" type="application/atom+xml">

  <meta name="go-import" content="github.com/foxx/foxx.github.io git https://github.com/foxx/foxx.github.io.git">

  <meta name="octolytics-dimension-user_id" content="651797" /><meta name="octolytics-dimension-user_login" content="foxx" /><meta name="octolytics-dimension-repository_id" content="14074601" /><meta name="octolytics-dimension-repository_nwo" content="foxx/foxx.github.io" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="14074601" /><meta name="octolytics-dimension-repository_network_root_nwo" content="foxx/foxx.github.io" /><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false" />


    <link rel="canonical" href="https://github.com/foxx/foxx.github.io/blob/master/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown" data-pjax-transient>


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://assets-cdn.github.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://assets-cdn.github.com/favicon.ico">

<meta name="theme-color" content="#1e2327">



  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-blob">
    

  <div class="position-relative js-header-wrapper ">
    <a href="#start-of-content" tabindex="1" class="px-2 py-4 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    



        


  <header class="Header header-logged-out  position-relative f4 py-3" role="banner" >
    <div class="container-lg d-flex px-3">
      <div class="d-flex flex-justify-between flex-items-center">
        <a class="header-logo-invertocat my-0" href="https://github.com/" aria-label="Homepage" data-ga-click="(Logged out) Header, go to homepage, icon:logo-wordmark; experiment:site_header_dropdowns; group:control">
          <svg height="32" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
        </a>

      </div>

      <div class="HeaderMenu d-flex flex-justify-between flex-auto">
          <nav class="mt-0">
            <ul class="d-flex list-style-none">
                <li class="ml-2">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:features; experiment:site_header_dropdowns; group:control" data-selected-links="/features /features/project-management /features/code-review /features/project-management /features/integrations /features" href="/features">
                    Features
</a>                </li>
                <li class="ml-4">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:business; experiment:site_header_dropdowns; group:control" data-selected-links="/business /business/security /business/customers /business" href="/business">
                    Business
</a>                </li>

                <li class="ml-4">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:explore; experiment:site_header_dropdowns; group:control" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="/explore">
                    Explore
</a>                </li>

                <li class="ml-4">
                      <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:marketplace; experiment:site_header_dropdowns; group:control" data-selected-links=" /marketplace" href="/marketplace">
                        Marketplace
</a>                </li>
                <li class="ml-4">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:pricing; experiment:site_header_dropdowns; group:control" data-selected-links="/pricing /pricing/developer /pricing/team /pricing/business-hosted /pricing/business-enterprise /pricing" href="/pricing">
                    Pricing
</a>                </li>
            </ul>
          </nav>

        <div class="d-flex">
            <div class="d-lg-flex flex-items-center mr-3">
              <div class="header-search scoped-search site-scoped-search js-site-search position-relative js-jump-to"
  role="combobox"
  aria-owns="jump-to-results"
  aria-label="Search or jump to"
  aria-haspopup="listbox"
  aria-expanded="false"
>
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-site-search-form" data-scope-type="Repository" data-scope-id="14074601" data-scoped-search-url="/foxx/foxx.github.io/search" data-unscoped-search-url="/search" action="/foxx/foxx.github.io/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
      <label class="form-control header-search-wrapper header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
        <input type="text"
          class="form-control header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
          data-hotkey="s,/"
          name="q"
          value=""
          placeholder="Search"
          data-unscoped-placeholder="Search GitHub"
          data-scoped-placeholder="Search"
          autocapitalize="off"
          aria-autocomplete="list"
          aria-controls="jump-to-results"
          data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations#csrf-token=5t7r55+HWJrP1W7sTw1RCjGcyBkva9DrkuxSgmVmxJpmK5F0GPgD9n0n1isijlM2dFBWpwUXMEnopFo7wUeB6A=="
          spellcheck="false"
          autocomplete="off"
          >
          <input type="hidden" class="js-site-search-type-field" name="type" >
            <img src="https://assets-cdn.github.com/images/search-shortcut-hint.svg" alt="" class="mr-2 header-search-key-slash">

            <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
              <ul class="d-none js-jump-to-suggestions-template-container">
                <li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item" role="option">
                  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center p-2 jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open" href="">
                    <div class="jump-to-octicon js-jump-to-octicon mr-2 text-center d-none">
                      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
                      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
                      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"/></svg>
                    </div>

                    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

                    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
                    </div>

                    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
                      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
                        In this repository
                      </span>
                      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
                        All GitHub
                      </span>
                      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
                    </div>

                    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
                      Jump to
                      <span class="d-inline-block ml-1 v-align-middle">↵</span>
                    </div>
                  </a>
                </li>
              </ul>
              <ul class="d-none js-jump-to-no-results-template-container">
                <li class="d-flex flex-justify-center flex-items-center p-3 f5 d-none">
                  <span class="text-gray">No suggested jump to results</span>
                </li>
              </ul>

              <ul id="jump-to-results" role="listbox" class="js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container" >
                <li class="d-flex flex-justify-center flex-items-center p-0 f5">
                  <img src="https://assets-cdn.github.com/images/spinners/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
                </li>
              </ul>
            </div>
      </label>
</form>  </div>
</div>

            </div>

          <span class="d-inline-block">
              <div class="HeaderNavlink px-0 py-2 m-0">
                <a class="text-bold text-white no-underline" href="/login?return_to=%2Ffoxx%2Ffoxx.github.io%2Fblob%2Fmaster%2F_posts%2F2012-10-26-access-virus-ti-firmware-reverse.markdown" data-ga-click="(Logged out) Header, clicked Sign in, text:sign-in; experiment:site_header_dropdowns; group:control">Sign in</a>
                  <span class="text-gray">or</span>
                  <a class="text-bold text-white no-underline" href="/join?source=header-repo" data-ga-click="(Logged out) Header, clicked Sign up, text:sign-up; experiment:site_header_dropdowns; group:control">Sign up</a>
              </div>
          </span>
        </div>
      </div>
    </div>
  </header>

  </div>

  <div id="start-of-content" class="show-on-focus"></div>

    <div id="js-flash-container">


</div>



  <div role="main" class="application-main ">
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <div id="js-repo-pjax-container" data-pjax-container >
      







  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav  ">
    <div class="repohead-details-container clearfix container">

      <ul class="pagehead-actions">
  <li>
      <a href="/login?return_to=%2Ffoxx%2Ffoxx.github.io"
    class="btn btn-sm btn-with-count tooltipped tooltipped-s"
    aria-label="You must be signed in to watch a repository" rel="nofollow">
    <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
    Watch
  </a>
  <a class="social-count" href="/foxx/foxx.github.io/watchers"
     aria-label="1 user is watching this repository">
    1
  </a>

  </li>

  <li>
      <a href="/login?return_to=%2Ffoxx%2Ffoxx.github.io"
    class="btn btn-sm btn-with-count tooltipped tooltipped-s"
    aria-label="You must be signed in to star a repository" rel="nofollow">
    <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"/></svg>
    Star
  </a>

    <a class="social-count js-social-count" href="/foxx/foxx.github.io/stargazers"
      aria-label="0 users starred this repository">
      0
    </a>

  </li>

  <li>
      <a href="/login?return_to=%2Ffoxx%2Ffoxx.github.io"
        class="btn btn-sm btn-with-count tooltipped tooltipped-s"
        aria-label="You must be signed in to fork a repository" rel="nofollow">
        <svg class="octicon octicon-repo-forked v-align-text-bottom" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
        Fork
      </a>

    <a href="/foxx/foxx.github.io/network/members" class="social-count"
       aria-label="1 user forked this repository">
      1
    </a>
  </li>
</ul>

      <h1 class="public ">
  <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" href="/foxx">foxx</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="/foxx/foxx.github.io">foxx.github.io</a></strong>

</h1>

    </div>
    
<nav class="reponav js-repo-nav js-sidenav-container-pjax container"
     itemscope
     itemtype="http://schema.org/BreadcrumbList"
     role="navigation"
     data-pjax="#js-repo-pjax-container">

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /foxx/foxx.github.io" href="/foxx/foxx.github.io">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /foxx/foxx.github.io/issues" href="/foxx/foxx.github.io/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">0</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /foxx/foxx.github.io/pulls" href="/foxx/foxx.github.io/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">0</span>
      <meta itemprop="position" content="3">
</a>  </span>

    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /foxx/foxx.github.io/projects" href="/foxx/foxx.github.io/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      Projects
      <span class="Counter" >0</span>
</a>



  <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse alerts /foxx/foxx.github.io/pulse" href="/foxx/foxx.github.io/pulse">
    <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"/></svg>
    Insights
</a>

</nav>


  </div>

<div class="container new-discussion-timeline experiment-repo-nav  ">
  <div class="repository-content ">

    
  <a class="d-none js-permalink-shortcut" data-hotkey="y" href="/foxx/foxx.github.io/blob/b637521b150f24e574230044113ed86fc7b0d69b/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown">Permalink</a>

  <!-- blob contrib key: blob_contributors:v21:a351d58f29a23367cf0a97a12b782baa -->

      <div class="signup-prompt-bg rounded-1">
      <div class="signup-prompt p-4 text-center mb-4 rounded-1">
        <div class="position-relative">
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form action="/site/dismiss_signup_prompt" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="yXqcnMkiUzhDK53x9YwCVIb50ZXF0h7IceMCjzWuJdmA8EVpqkYhcFOf1IKgalUxXaSawSKpaXlNBnSD1nCHTA==" />
            <button type="submit" class="position-absolute top-0 right-0 btn-link link-gray" data-ga-click="(Logged out) Sign up prompt, clicked Dismiss, text:dismiss">
              Dismiss
            </button>
</form>          <h3 class="pt-2">Join GitHub today</h3>
          <p class="col-6 mx-auto">GitHub is home to over 28 million developers working together to host and review code, manage projects, and build software together.</p>
          <a class="btn btn-primary" href="/join?source=prompt-blob-show" data-ga-click="(Logged out) Sign up prompt, clicked Sign up, text:sign-up">Sign up</a>
        </div>
      </div>
    </div>


  <div class="file-navigation">
    
<div class="select-menu branch-select-menu js-menu-container js-select-menu float-left">
  <button class=" btn btn-sm select-menu-button js-menu-target css-truncate" data-hotkey="w"
    
    type="button" aria-label="Switch branches or tags" aria-expanded="false" aria-haspopup="true">
      <i>Branch:</i>
      <span class="js-select-button css-truncate-target">master</span>
  </button>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax>

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <svg class="octicon octicon-x js-menu-close" role="img" aria-label="Close" viewBox="0 0 12 16" version="1.1" width="12" height="16"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
        <span class="select-menu-title">Switch branches/tags</span>
      </div>

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Filter branches/tags" id="context-commitish-filter-field" class="form-control js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" data-filter-placeholder="Filter branches/tags" class="js-select-menu-tab" role="tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" data-filter-placeholder="Find a tag…" class="js-select-menu-tab" role="tab">Tags</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches" role="menu">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/foxx/foxx.github.io/blob/backup/baddesign/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown"
               data-name="backup/baddesign"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                backup/baddesign
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/foxx/foxx.github.io/blob/feature/fixdesign/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown"
               data-name="feature/fixdesign"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                feature/fixdesign
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open selected"
               href="/foxx/foxx.github.io/blob/master/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown"
               data-name="master"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                master
              </span>
            </a>
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div>

    </div>
  </div>
</div>

    <div class="BtnGroup float-right">
      <a href="/foxx/foxx.github.io/find/master"
            class="js-pjax-capture-input btn btn-sm BtnGroup-item"
            data-pjax
            data-hotkey="t">
        Find file
      </a>
      <clipboard-copy for="blob-path" class="btn btn-sm BtnGroup-item">
        Copy path
      </clipboard-copy>
    </div>
    <div id="blob-path" class="breadcrumb">
      <span class="repo-root js-repo-root"><span class="js-path-segment"><a data-pjax="true" href="/foxx/foxx.github.io"><span>foxx.github.io</span></a></span></span><span class="separator">/</span><span class="js-path-segment"><a data-pjax="true" href="/foxx/foxx.github.io/tree/master/_posts"><span>_posts</span></a></span><span class="separator">/</span><strong class="final-path">2012-10-26-access-virus-ti-firmware-reverse.markdown</strong>
    </div>
  </div>


  
  <div class="commit-tease">
      <span class="float-right">
        <a class="commit-tease-sha" href="/foxx/foxx.github.io/commit/524753664349b6465771c318ef793331939d2e6b" data-pjax>
          5247536
        </a>
        <relative-time datetime="2015-02-07T19:57:41Z">Feb 7, 2015</relative-time>
      </span>
      <div>
        <img class="avatar" width="20" height="20" alt="" src="https://camo.githubusercontent.com/a52abe7f8be096aa4e2e03c7fe5c1ef5012b2cb4/68747470733a2f2f322e67726176617461722e636f6d2f6176617461722f30303233353535646364336331646433363863313330316161613264313663333f643d68747470732533412532462532466173736574732d63646e2e6769746875622e636f6d253246696d6167657325324667726176617461727325324667726176617461722d757365722d3432302e706e6726723d6726733d313430" data-canonical-src="https://2.gravatar.com/avatar/0023555dcd3c1dd368c1301aaa2d16c3?d=https%3A%2F%2Fassets-cdn.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png&amp;r=g&amp;s=140" />
        <span class="user-mention">Cal Leeming</span>
          <a data-pjax="true" title="Added new post about Docker + fixes
- repositioned posts
- fixed provisioning bug" class="message" href="/foxx/foxx.github.io/commit/524753664349b6465771c318ef793331939d2e6b">Added new post about Docker + fixes</a>
      </div>

    <div class="commit-tease-contributors">
      
<details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2" id="blob_contributors_box">
  <summary class="btn-link" aria-haspopup="dialog"  >
    
    <span><strong>1</strong> contributor</span>
  </summary>
  <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast " aria-label="Users who have contributed to this file">
    <div class="Box-header">
      <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog>
        <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
      </button>
      <h3 class="Box-title">Users who have contributed to this file</h3>
    </div>
    
        <ul class="list-style-none overflow-auto">
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/foxx">
                <img class="avatar mr-2" alt="" src="https://avatars2.githubusercontent.com/u/651797?s=40&amp;v=4" width="20" height="20" />
                foxx
</a>            </li>
        </ul>

  </details-dialog>
</details>
      
    </div>
  </div>



  <div class="file">
    <div class="file-header">
  <div class="file-actions">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="/foxx/foxx.github.io/raw/master/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="/foxx/foxx.github.io/blame/master/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="/foxx/foxx.github.io/commits/master/_posts/2012-10-26-access-virus-ti-firmware-reverse.markdown">History</a>
    </div>

        <a class="btn-octicon tooltipped tooltipped-nw"
           href="https://desktop.github.com"
           aria-label="Open this file in GitHub Desktop"
           data-ga-click="Repository, open with desktop, type:windows">
            <svg class="octicon octicon-device-desktop" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z"/></svg>
        </a>

        <button type="button" class="btn-octicon disabled tooltipped tooltipped-nw"
          aria-label="You must be signed in to make or propose changes">
          <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"/></svg>
        </button>
        <button type="button" class="btn-octicon btn-octicon-danger disabled tooltipped tooltipped-nw"
          aria-label="You must be signed in to make or propose changes">
          <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"/></svg>
        </button>
  </div>

  <div class="file-info">
      645 lines (554 sloc)
      <span class="file-info-divider"></span>
    30.7 KB
  </div>
</div>

    
  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>layout</th>
  <th>title</th>
  <th>date</th>
  <th>categories</th>
  <th>coverimage</th>
  <th>type</th>
  <th>weight</th>
  <th>keywords</th>
  <th>desc</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>post</div></td>
  <td><div>Access Virus TI Firmware Reverse Engineering - Attempt 1</div></td>
  <td><div>2012-10-25 17:00:00 -0700</div></td>
  <td><div>general</div></td>
  <td><div>/img/covers/access_virus_ti_03.jpg</div></td>
  <td><div>large</div></td>
  <td><div>15</div></td>
  <td><div>access virus ti, access virus, reverse engineering, firmware, cutting, python, idapro, ida pro</div></td>
  <td><div>Reverse engineering and cutting the Access Virus TI firmware using Python and IDA Pro</div></td>
  </tr>
  </tbody>
</table>

<p>After several times of looking around on eBay for an Access Virus TI, and each time deciding that I didn't really have £800 to blow on a unit, I went in search of a firmware emulator. This drew a blank, so I decided to have a shot at poking into the firmware. I'd done this a few times before (mostly with phones and routers), but never with this. I didn't have an actual unit to look inside, so first I had to find some pictures and/or a hardware spec.</p>
<h3><a id="user-content-lets-get-started" class="anchor" aria-hidden="true" href="#lets-get-started"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lets get started</h3>
<p>I am by no means an expert when it comes to this subject, so some information on this post may be incorrect. The tools used were Windows 7, IDA Pro, binwalk, Hex Workshop, various 563xx tools (see below)</p>
<p>Luckily for me this work had already been done by the guys over at midibox:</p>
<p>{% highlight text %}</p>
<ul>
<li>2X Freescale 150mhz dspb56367ac150 DSP's (the nord lead 3 has 6x 120's)</li>
<li>6x samsung k6r4008v10-ui10 memory chips,</li>
<li>A totally seperate keyboard controller with 4mhz pic (pic16c238-04/sp) - connected to virus thru midi !</li>
<li>lots of ne5532 opamps,</li>
<li>Somesort of ST electronics dsp (lettering unreadable) connected to a samsung kex400874e-uf70 memory chip,</li>
<li>Cirrus logic, one chip adc/dac cs12556-c31,</li>
<li>Texas Instruments tusb3200ac streaming usb controller,</li>
<li>Lots of White leds,</li>
<li>A white finish thats highly prone to shoing up dust, grime &amp; scratches,</li>
<li>Very heavy aluminum end caps (at least it feels solid),</li>
<li>the front wooden bar is mdf with wooden vineer, lime ?</li>
<li>A 'trailing blob' psu -inside- the case,</li>
<li>a really dodgy looking power cap.. that looked ready to explode.
{% endhighlight %}</li>
</ul>
<p>I had some difficulty finding an exact match for "dspb56367ac150", but we did find a DSP56367, which is part of the Motorola DSP 563xx Freescale family (24-bit @ 150mhz). Here is a link to the specification of this chip <a href="http://www.freescale.com/files/dsp/doc/data_sheet/DSP56367.pdf" rel="nofollow">www.freescale.com/files/dsp/doc/data_sheet/DSP56367.pdf</a></p>
<p>Extracting firmware from installation Next was to get hold of their latest firmware/software, which was a bit tricky. This involved signing up for an account on their website, confirming via email, then downloading the relevant software. In our case, we found the following file on their site;</p>
<p>{% highlight text %}</p>
<ul>
<li>Virus TI Software Installer_v45300_x64.zip</li>
<li>Virus TI Software Installer 64-bit.msi</li>
<li>Virus TI Setup Guide.pdf<br>
{% endhighlight %}</li>
</ul>
<p>After extracting the MSI with 7zip (no need to install), this gave us the following files;</p>
<p>{% highlight text %}
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 AbletonLive6_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Atmosphere_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Attack01_12_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Attack13_24_vrt<br>
-rw-r--r-- 1 foxx foxx 66K Jan 13 2009 BackupTI2ROMA<br>
-rw-r--r-- 1 foxx foxx 66K Jan 13 2009 BackupTI2ROMB<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMC<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMD<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROME<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMF<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMG<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMH<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMI<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMJ<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMK<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROML<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMM<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMN<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMO<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMP<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMQ<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMR<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMS<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMT<br>
-rw-r--r-- 1 foxx foxx 66K Jan 8 2009 BackupTI2ROMU<br>
-rw-r--r-- 1 foxx foxx 66K Jan 19 2009 BackupTI2ROMV<br>
-rw-r--r-- 1 foxx foxx 66K Jan 19 2009 BackupTI2ROMW<br>
-rw-r--r-- 1 foxx foxx 66K Jan 19 2009 BackupTI2ROMX<br>
-rw-r--r-- 1 foxx foxx 66K Jan 19 2009 BackupTI2ROMY<br>
-rw-r--r-- 1 foxx foxx 66K Jan 19 2009 BackupTI2ROMZ<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMA<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMB<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMC<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMD<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROME<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMF<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMG<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMH<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMI<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMJ<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMK<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROML<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMM<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMN<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMO<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMP<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMQ<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMR<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTIROMS<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTISnowROMA<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTISnowROMB<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTISnowROMC<br>
-rw-r--r-- 1 foxx foxx 66K Oct 9 2008 BackupTISnowROMD<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 ca5000_vrt<br>
-rw-r--r-- 1 foxx foxx 508K May 11 2010 DIFXApiDll<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Discoveryv2_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 DrREX_BL_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 EMU_Proteus_2000_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Evolver_vrt<br>
-rw-r--r-- 1 foxx foxx 8.1M Oct 17 2011 firmware_bin<br>
-rw-r--r-- 1 foxx foxx 8.1M Oct 17 2011 firmware_bin64<br>
-rw-r--r-- 1 foxx foxx 298K Oct 14 2011 firmwareupdater_exe<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 hybrid_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 ImpOSCar_vrt<br>
-rw-r--r-- 1 foxx foxx 1.6M Oct 14 2011 installassist_exe<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Korg_MS20_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Korg_Polysix_vrt<br>
-rw-r--r-- 1 foxx foxx 1.9K Oct 9 2008 Live6RemoteInstall_rtf<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Malstrom_BL_vrt<br>
-rw-r--r-- 1 foxx foxx 2.2K Oct 9 2008 manual_ico<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 MiniMonsta_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Moog_Voyager_RME_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 NovationKSRack_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 NovationNova_vrt<br>
-rw-r--r-- 1 foxx foxx 20K Jan 8 2009 PAOS3FXDemo<br>
-rw-r--r-- 1 foxx foxx 30K Mar 23 2011 PAOS45FeaturesDemo<br>
-rw-r--r-- 1 foxx foxx 44K Feb 16 2010 PAOS4FeaturesDemo<br>
-rw-r--r-- 1 foxx foxx 6.8K Oct 9 2008 PATAtomizer<br>
-rw-r--r-- 1 foxx foxx 26 Oct 9 2008 PATMyPatches<br>
-rw-r--r-- 1 foxx foxx 17K Oct 9 2008 PATOS2Patches<br>
-rw-r--r-- 1 foxx foxx 17K Oct 9 2008 PATTutorial<br>
-rw-r--r-- 1 foxx foxx 16K Oct 9 2008 PAVocoderInput<br>
-rw-r--r-- 1 foxx foxx 704K Oct 9 2008 PDF_AbletonLiveTutorial<br>
-rw-r--r-- 1 foxx foxx 2.6M Oct 14 2011 PDF_Addendum<br>
-rw-r--r-- 1 foxx foxx 265K Mar 15 2011 PDF_Atomizer_Manual<br>
-rw-r--r-- 1 foxx foxx 103K Oct 14 2011 PDF_Changelog<br>
-rw-r--r-- 1 foxx foxx 756K Oct 9 2008 PDF_CubaseTutorial<br>
-rw-r--r-- 1 foxx foxx 1.1M Oct 9 2008 PDF_FLStudioTutorial<br>
-rw-r--r-- 1 foxx foxx 53K Mar 16 2011 PDF_LicenseAgreement<br>
-rw-r--r-- 1 foxx foxx 198K Oct 9 2008 PDF_Patchnames<br>
-rw-r--r-- 1 foxx foxx 260K Oct 9 2008 PDF_ProtoolsTutorial<br>
-rw-r--r-- 1 foxx foxx 49K Mar 15 2011 PDF_Readme_EN<br>
-rw-r--r-- 1 foxx foxx 4.5M Jul 28 2011 PDF_SonarTutorial<br>
-rw-r--r-- 1 foxx foxx 839K Oct 9 2008 PDF_TutorialProgramming<br>
-rw-r--r-- 1 foxx foxx 433K Oct 9 2008 PDF_TutorialVirusControl<br>
-rw-r--r-- 1 foxx foxx 2.4M Mar 15 2011 PDF_VirusSnow_Quickstart<br>
-rw-r--r-- 1 foxx foxx 1.8M Jan 6 2009 PDF_VirusSnow_Reference<br>
-rw-r--r-- 1 foxx foxx 2.2M Mar 15 2011 PDF_VirusTI_Quickstart<br>
-rw-r--r-- 1 foxx foxx 1.8M Mar 15 2011 PDF_VirusTI_Reference<br>
-rw-r--r-- 1 foxx foxx 609K Mar 15 2011 PDF_VirusTI_Setup_Guide<br>
-rw-r--r-- 1 foxx foxx 16K Oct 9 2008 PDF_Warranty_Card<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 PPGWave2V_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Pro_53_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 RolandJuno106_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 S_Bass_Station_vrt<br>
-rw-r--r-- 1 foxx foxx 330K Oct 9 2008 setup_cd_ico<br>
-rw-r--r-- 1 foxx foxx 2.3K Mar 17 2011 Sidstation_vrt<br>
-rw-r--r-- 1 foxx foxx 157K Mar 23 2011 SNG_AbletonLiveTutorialSong<br>
-rw-r--r-- 1 foxx foxx 104K Jun 17 2011 SNG_AbletonLiveTutorialSongSnow<br>
-rw-r--r-- 1 foxx foxx 143K Mar 23 2011 SNG_CubaseTutorial<br>
-rw-r--r-- 1 foxx foxx 116K Oct 9 2008 SNG_CubaseTutorialSnow<br>
-rw-r--r-- 1 foxx foxx 236K Jul 28 2011 SNG_FLStudioTutorialSong<br>
-rw-r--r-- 1 foxx foxx 169K Oct 9 2008 SNG_ProtoolsTutorialSong<br>
-rw-r--r-- 1 foxx foxx 159K Oct 9 2008 SNG_ProtoolsTutorialSongSnow<br>
-rw-r--r-- 1 foxx foxx 270K Jul 28 2011 SNG_SonarTutorialSong<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 strike_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Stylus_RMX_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Subtractor_BL_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 synchronic_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 TCMercury_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 The_Oddity_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Trilogy_vrt<br>
-rw-r--r-- 1 foxx foxx 3.3K Oct 9 2008 UserConfiguration_txt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 Vanguard_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 velvet_vrt<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 VirusABC_vrt<br>
-rw-r--r-- 1 foxx foxx 3.1M Oct 17 2011 viruscontrolcenter_exe<br>
-rw-r--r-- 1 foxx foxx 14M Oct 17 2011 viruscontrol_dll<br>
-rw-r--r-- 1 foxx foxx 14M Oct 17 2011 viruscontrol_dll64<br>
-rw-r--r-- 1 foxx foxx 565K Oct 14 2011 VirusControlPluginTISnowVST<br>
-rw-r--r-- 1 foxx foxx 157K Oct 14 2011 VirusControlPluginTISnowVST64<br>
-rw-r--r-- 1 foxx foxx 565K Oct 14 2011 VirusControlRTAS_TI_DPM<br>
-rw-r--r-- 1 foxx foxx 286 Oct 9 2008 VirusControlRTAS_TI_Res<br>
-rw-r--r-- 1 foxx foxx 565K Oct 14 2011 VirusControlVST3<br>
-rw-r--r-- 1 foxx foxx 157K Oct 14 2011 VirusControlVST364<br>
-rw-r--r-- 1 foxx foxx 27K Oct 9 2008 VirusTI_ctl_rmx<br>
-rw-r--r-- 1 foxx foxx 253K Oct 14 2011 VirusUpdaterDll<br>
-rw-r--r-- 1 foxx foxx 304K Oct 14 2011 VirusUpdaterDll64<br>
-rw-r--r-- 1 foxx foxx 7.9K May 27 2010 virususb_cat<br>
-rw-r--r-- 1 foxx foxx 221K May 27 2010 virususb_dll<br>
-rw-r--r-- 1 foxx foxx 1.9K May 27 2010 virususb_inf<br>
-rw-r--r-- 1 foxx foxx 458K May 27 2010 virususb_sys<br>
-rw-r--r-- 1 foxx foxx 243K May 27 2010 virususbx64_dll<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 V_Station_vrt<br>
-rw-r--r-- 1 foxx foxx 7.8K May 27 2010 vtiaudio_cat<br>
-rw-r--r-- 1 foxx foxx 3.6K May 27 2010 vtiaudio_inf<br>
-rw-r--r-- 1 foxx foxx 49K May 27 2010 vtiaudio_sys<br>
-rw-r--r-- 1 foxx foxx 7.9K May 11 2010 vtimidi_cat<br>
-rw-r--r-- 1 foxx foxx 4.3K May 11 2010 vtimidi_inf<br>
-rw-r--r-- 1 foxx foxx 32K May 11 2010 vtimidi_sys<br>
-rw-r--r-- 1 foxx foxx 2.3K Oct 9 2008 xpand_vrt<br>
{% endhighlight %}</p>
<p>Obviously, the file that drew our attention the most was firmware_bin64, so lets have a look at what our initial inspections show According to Google, IFF is basically an image format, so this is probably a false positive.</p>
<p>{% highlight bash %}
$ file firmware_bin64<br>
firmware_bin64: IFF data<br>
{% endhighlight %}</p>
<p>Strings shows some interesting results, the fact we have a list of file names near the start means we're probably dealing with some sort of compressed archive or squashed file.</p>
<p>{% highlight bash %}
$ strings firmware_bin64 | head -n10<br>
FORM<br>
QTABL<br>
2lcd_backup_000.bin<br>
lcd_backup_001.bin<br>
lcd_backup_002.bin<br>
lcd_backup_003.bin<br>
lcd_backup_004.bin<br>
lcd_backup_005.bin<br>
lcd_backup_006.bin<br>
lcd_backup_007.bin<br>
---| SNIPPED ---|<br>
{% endhighlight %}</p>
<p>Binwalk opcodes scan shows the binary might have an ARM bootloader somewhere in there, but this could be a false positive.</p>
<p>{% highlight bash %}
$ binwalk -A firmware_bin64</p>
<p>DECIMAL HEX DESCRIPTION<br>
------------------------------------------------------------------------------------------------------|-<br>
534627 0x82863 ARM function prologue<br>
540298 0x83E8A ARMEB function epilogue<br>
541085 0x8419D ARMEB function epilogue<br>
548901 0x86025 ARM function epilogue<br>
567524 0x8A8E4 ARM function epilogue<br>
769219 0xBBCC3 ARMEB function epilogue<br>
797858 0xC2CA2 ARMEB function prologue<br>
842578 0xCDB52 ARM function epilogue<br>
847009 0xCECA1 ARM function epilogue<br>
2658496 0x2890C0 ARMEB function prologue<br>
2658531 0x2890E3 ARMEB function prologue<br>
2658566 0x289106 ARMEB function prologue<br>
2658601 0x289129 ARMEB function prologue<br>
2658636 0x28914C ARMEB function prologue<br>
2658671 0x28916F ARMEB function prologue<br>
2658706 0x289192 ARMEB function prologue<br>
2658741 0x2891B5 ARMEB function prologue<br>
3904543 0x3B941F ARM function prologue<br>
3910214 0x3BAA46 ARMEB function epilogue<br>
3911001 0x3BAD59 ARMEB function epilogue<br>
3918817 0x3BCBE1 ARM function epilogue<br>
3937440 0x3C14A0 ARM function epilogue<br>
4139135 0x3F287F ARMEB function epilogue<br>
4167774 0x3F985E ARMEB function prologue<br>
4212494 0x40470E ARM function epilogue<br>
4216925 0x40585D ARM function epilogue<br>
6167275 0x5E1AEB ARM function prologue<br>
6176235 0x5E3DEB ARM function prologue<br>
6185195 0x5E60EB ARM function prologue<br>
6194155 0x5E83EB ARM function prologue<br>
7453605 0x71BBA5 ARM function prologue<br>
7459276 0x71D1CC ARMEB function epilogue<br>
7460063 0x71D4DF ARMEB function epilogue<br>
7467879 0x71F367 ARM function epilogue<br>
7486502 0x723C26 ARM function epilogue<br>
7687954 0x754F12 ARMEB function epilogue<br>
7716593 0x75BEF1 ARMEB function prologue<br>
7765801 0x767F29 ARM function epilogue<br>
{% endhighlight %}</p>
<p>Binwalk normal scan shows a lot of LZMA data, but this looks to be mostly false positives:</p>
<p>{% highlight python %}
$ binwalk firmware_bin64 | head -n10</p>
<p>DECIMAL HEX DESCRIPTION<br>
------------------------------------------------------------------------------------------------------|-<br>
146122 0x23ACA LZMA compressed data, properties: 0x90, dictionary size: 50331648 bytes, uncompressed size: 49186 bytes<br>
369588 0x5A3B4 LZMA compressed data, properties: 0xD0, dictionary size: 1074331648 bytes, uncompressed size: 160 bytes<br>
369727 0x5A43F LZMA compressed data, properties: 0xD0, dictionary size: 150994944 bytes, uncompressed size: 8257 bytes<br>
372248 0x5AE18 LZMA compressed data, properties: 0xD3, dictionary size: 1242103808 bytes, uncompressed size: 32 bytes<br>
372317 0x5AE5D LZMA compressed data, properties: 0xD3, dictionary size: 150994944 bytes, uncompressed size: 24650 bytes<br>
582498 0x8E362 LZMA compressed data, properties: 0x84, dictionary size: 553648128 bytes, uncompressed size: 210 bytes<br>
582840 0x8E4B8 LZMA compressed data, properties: 0x84, dictionary size: 553648128 bytes, uncompressed size: 213 bytes<br>
{% endhighlight %}</p>
<p>A further binwalk scan shows the presence of a JFFS2 filesystem and a PNG image.</p>
<p>{% highlight python %}
$ binwalk firmware_bin64 | grep -v LZMA</p>
<p>DECIMAL HEX DESCRIPTION<br>
------------------------------------------------------------------------------------------------------|-<br>
3214531 0x310CC3 JFFS2 filesystem (old) data big endian, JFFS node length: 39<br>
8385066 0x7FF22A PNG image, 21 x 21, 8-bit/color RGBA, non-interlaced<br>
{% endhighlight %}</p>
<p>When we attempted to extract and mount the JFFS, this ended with failure. Upon inspecting the extracted data with file and binwalk, it would appear that this is also a false positive.</p>
<p>{% highlight bash %}
$ dd if=firmware_bin64 bs=1 skip=3214531 of=1.jffs<br>
5174422+0 records in<br>
5174422+0 records out<br>
5174422 bytes (5.2 MB) copied, 5.18494 s, 998 kB/s</p>
<p>$ sudo mount -t jffs2 1.jffs lol<br>
mount: 1.jffs is not a block device (maybe try `-o loop'?)</p>
<p>$ sudo mount -o loop -t jffs2 1.jffs lol<br>
mount: wrong fs type, bad option, bad superblock on /dev/loop0,<br>
missing codepage or helper program, or other error<br>
In some cases useful info is found in syslog - try<br>
dmesg | tail or so</p>
<p>$ file 1.jffs<br>
1.jffs: data</p>
<p>$ binwalk 1.jffs | grep -v LZMA</p>
<p>DECIMAL HEX DESCRIPTION<br>
------------------------------------------------------------------------------------------------------|-<br>
0 0x0 JFFS2 filesystem (old) data big endian, JFFS node length: 39<br>
{% endhighlight %}</p>
<p>Unpacking firmware So next we take a look at the firmware image inside a hex editor, and see what is going on.</p>
<p><a href="/foxx/foxx.github.io/blob/master/img/postcontent/access-virus-1.png"><img src="/foxx/foxx.github.io/raw/master/img/postcontent/access-virus-1.png" alt="access-virus-1.png" style="max-width:100%;"></a></p>
<p>{% highlight text %}</p>
<ol>
<li>size of the file list data chunk (03AE hex = 942)</li>
<li>list of files (50 to be exact), separated out by a null byte (\x00): 941 bytes + 1 byte separator</li>
<li>file number chunk + null byte (\x00) separator: starts at 0001</li>
<li>Header identifier of some sort<br>
{% endhighlight %}</li>
</ol>
<p>The way we found out that (3) was a file number chunk, was by converting the ASCII string "0001" through to "0050", adding a null byte, then searching in our hex editor (example: 3030 3439 00 = 0049.) Every time we searched, we were able to find a match, followed by what looked like readable information, such as:</p>
<p>{% highlight text %}
0047......
.
.&lt;titl
{% endhighlight %}</p>
<p>{% highlight text %}
`0050....@charset "UTF-8";..VirusControlStyles {.}.p {..font-family: Geneva, Arial, Helvetica, sans-serif;..font-size: 12px;..font-style: normal;..font-weight: normal;..font-variant: normal;..text-transform: none;..color: #FFFFFF;.}.h1 {..font-family: Genev<br>
{% endhighlight %}</p>
<p>Problem now is that we don't seem to have any chunk sizes for each file, and we still need to ensure this theory is correct. So a quick and dirty python script does the following:</p>
<p>{% highlight text %}</p>
<ul>
<li>Jump to the end of the header identifier</li>
<li>Grab the size of the file list data chunk</li>
<li>Extract file list data chunk</li>
<li>Iterate over file list (increment from 1, zfill 4 positions with zeros, so 1 becomes 0001)</li>
<li>Scan the firmware for 0001~0050 followed by null byte</li>
</ul>
<h1><a id="user-content-1st-col--hex-representation-of-the-first-4-bytes-of-data-file-number-chunk" class="anchor" aria-hidden="true" href="#1st-col--hex-representation-of-the-first-4-bytes-of-data-file-number-chunk"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1st col = hex representation of the first 4 bytes of data (file number chunk)</h1>
<h1><a id="user-content-2nd-col--seperator-on-the-5th-byte-should-always-be-null" class="anchor" aria-hidden="true" href="#2nd-col--seperator-on-the-5th-byte-should-always-be-null"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2nd col = seperator on the 5th byte (should always be null)</h1>
<h1><a id="user-content-3rd-col--hex-representation-of-bytes-range-510" class="anchor" aria-hidden="true" href="#3rd-col--hex-representation-of-bytes-range-510"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3rd col = hex representation of bytes range 5~10</h1>
<h1><a id="user-content-4th-col---ascii-representation-of-bytes-range-510" class="anchor" aria-hidden="true" href="#4th-col---ascii-representation-of-bytes-range-510"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4th col - ascii representation of bytes range 5~10</h1>
<p>$ extract1.py<br>
30303031 00 0002800000 0001<br>
30303032 00 0002800000 0002<br>
30303033 00 0002800000 0003<br>
30303034 00 0002800000 0004<br>
30303035 00 0002800000 0005<br>
30303036 00 0002800000 0006<br>
30303037 00 0002800000 0007<br>
30303038 00 0002800000 0008<br>
30303039 00 0002800000 0009<br>
30303130 00 0002800000 0010<br>
30303131 00 0002800000 0011<br>
30303132 00 0002800000 0012<br>
30303133 00 0002800000 0013<br>
30303134 00 0002800000 0014<br>
30303135 00 0002800000 0015<br>
30303136 00 0002800000 0016<br>
30303137 00 0002800000 0017<br>
30303138 00 0002800000 0018<br>
30303139 00 0002800000 0019<br>
30303230 00 0002800000 0020<br>
30303231 00 0002800000 0021<br>
30303232 00 0002800000 0022<br>
30303233 00 0002800000 0023<br>
30303234 00 0002800000 0024<br>
30303235 00 0002800000 0025<br>
30303236 00 0002800000 0026<br>
30303237 00 0002800000 0027<br>
30303238 00 0002800000 0028<br>
30303239 00 0002800000 0029<br>
30303330 00 0002800000 0030<br>
30303331 00 0002800000 0031<br>
30303332 00 0002800000 0032<br>
30303333 00 0002800000 0033<br>
30303334 00 0002800000 0034<br>
30303335 00 0002800000 0035<br>
30303336 00 0002800000 0036<br>
30303337 00 0002800000 0037<br>
30303338 00 0002800000 0038<br>
30303339 00 0002800000 0039<br>
30303430 00 0002800000 0040<br>
30303431 00 0002800000 0041<br>
30303432 00 0002800000 0042<br>
30303433 00 0002800000 0043<br>
30303434 00 2f0b64464f 0044/<br>
dFO<br>
30303435 00 336b4c464f 00453kLFO<br>
30303436 00 1cfe1a464f 0046þFO<br>
30303437 00 0006813c21 0047&lt;!<br>
30303438 00 0006193c21 0048&lt;!<br>
§P303439 00 000da78950 0049<br>
30303530 00 0001804063 0050@c<br>
{% endhighlight %}</p>
<p>So we now extract one of these files manually with our hex editor, and see what happens. To find our end chunk size, we simply look ahead at the next chunk, find its start position, offset by -1 byte, and we're all clear. (i.e. start at the ASCII position of 0001\x00, and extract everything before ASCII position 0002\x00).</p>
<p>There is a HTML and CSS which extracted without problem, however we can see that the PNG doesn't seem to work. If we compare the first 10 bytes of our PNG, with our random test PNG, we can see that we've got some extra bytes at the start.</p>
<p>Lets look at this a bit closer.. We have a null byte at the start, but we are then left with two inconsistently changing numbers. If we convert 0DA7 - we get 3495. Our output file is 3498, if we minus off the length of these extra bytes, these two numbers are exactly the same. This means that we are actually extracting 3 bytes too many, and that we didn't really need to use the look ahead method mentioned earlier.. but hey-ho!</p>
<p>{% highlight text %}</p>
<h1><a id="user-content-btn_helppng" class="anchor" aria-hidden="true" href="#btn_helppng"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>BTN_Help.png</h1>
<p>000DA789504E470D0A1A0A = ....PNG....</p>
<h1><a id="user-content-random-png" class="anchor" aria-hidden="true" href="#random-png"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RANDOM PNG</h1>
<p>89504E470D0A1A0A000000 = .PNG.......</p>
<h1><a id="user-content-extra-data-3-bytes-at-the-start-of-btn_helppng" class="anchor" aria-hidden="true" href="#extra-data-3-bytes-at-the-start-of-btn_helppng"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>EXTRA DATA (3 bytes at the start of BTN_Help.png)</h1>
<p>00 0D A7<br>
{% endhighlight %}</p>
<p>So, now we have our approach fine tuned, we attempt to extract all the chunks into individual files for easier analysis, using the above as a template. As you can see, the ASIZE/CSIZE are both matching (which means we are extracting the expected size). along with the original byte offsets and file names etc. This script also dumps the files out to disk for us.</p>
<p>{% highlight bash %}</p>
<h1><a id="user-content-fno--file-chunk-number-4x-zero-padded" class="anchor" aria-hidden="true" href="#fno--file-chunk-number-4x-zero-padded"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FNO = file chunk number (4x zero padded)</h1>
<h1><a id="user-content-fname--original-filename-from-file-list" class="anchor" aria-hidden="true" href="#fname--original-filename-from-file-list"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FNAME = original filename from file list</h1>
<h1><a id="user-content-spos--start-position-in-bytes-on-the-original-firmware-file" class="anchor" aria-hidden="true" href="#spos--start-position-in-bytes-on-the-original-firmware-file"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SPOS = start position in bytes on the original firmware file</h1>
<h1><a id="user-content-fspos--file-start-position-this-is-where-the-actual-file-starts" class="anchor" aria-hidden="true" href="#fspos--file-start-position-this-is-where-the-actual-file-starts"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>FSPOS = file start position (this is where the actual file starts)</h1>
<h1><a id="user-content-epos--end-position-in-bytes-this-is-where-the-actual-file-ends" class="anchor" aria-hidden="true" href="#epos--end-position-in-bytes-this-is-where-the-actual-file-ends"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>EPOS = end position in bytes (this is where the actual file ends)</h1>
<h1><a id="user-content-asize--size-of-extracted-chunk" class="anchor" aria-hidden="true" href="#asize--size-of-extracted-chunk"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ASIZE = size of extracted chunk</h1>
<h1><a id="user-content-csize--size-expected-by-the-firmware" class="anchor" aria-hidden="true" href="#csize--size-expected-by-the-firmware"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSIZE = size expected by the firmware</h1>
<p>$ python extract2.py<br>
FNO FNAME SPOS FSPOS EPOS ASIZE/CSIZE<br>
0001 lcd_backup_000.bin 958 966 1606 640/640<br>
0002 lcd_backup_001.bin 1606 1614 2254 640/640<br>
0003 lcd_backup_002.bin 2254 2262 2902 640/640<br>
0004 lcd_backup_003.bin 2902 2910 3550 640/640<br>
0005 lcd_backup_004.bin 3550 3558 4198 640/640<br>
0006 lcd_backup_005.bin 4198 4206 4846 640/640<br>
0007 lcd_backup_006.bin 4846 4854 5494 640/640<br>
0008 lcd_backup_007.bin 5494 5502 6142 640/640<br>
0009 lcd_backup_008.bin 6142 6150 6790 640/640<br>
0010 lcd_backup_009.bin 6790 6798 7438 640/640<br>
0011 lcd_configuring_000.bin 7438 7446 8086 640/640<br>
0012 lcd_configuring_001.bin 8086 8094 8734 640/640<br>
0013 lcd_connected_000.bin 8734 8742 9382 640/640<br>
0014 lcd_flashrom_000.bin 9382 9390 10030 640/640<br>
0015 lcd_flashrom_001.bin 10030 10038 10678 640/640<br>
0016 lcd_flashrom_002.bin 10678 10686 11326 640/640<br>
0017 lcd_flashrom_003.bin 11326 11334 11974 640/640<br>
0018 lcd_flashrom_004.bin 11974 11982 12622 640/640<br>
0019 lcd_flashrom_005.bin 12622 12630 13270 640/640<br>
0020 lcd_flashrom_006.bin 13270 13278 13918 640/640<br>
0021 lcd_flashrom_007.bin 13918 13926 14566 640/640<br>
0022 lcd_flashrom_008.bin 14566 14574 15214 640/640<br>
0023 lcd_flashrom_009.bin 15214 15222 15862 640/640<br>
0024 lcd_restore_000.bin 15862 15870 16510 640/640<br>
0025 lcd_restore_001.bin 16510 16518 17158 640/640<br>
0026 lcd_restore_002.bin 17158 17166 17806 640/640<br>
0027 lcd_restore_003.bin 17806 17814 18454 640/640<br>
0028 lcd_restore_004.bin 18454 18462 19102 640/640<br>
0029 lcd_restore_005.bin 19102 19110 19750 640/640<br>
0030 lcd_restore_006.bin 19750 19758 20398 640/640<br>
0031 lcd_restore_007.bin 20398 20406 21046 640/640<br>
0032 lcd_restore_008.bin 21046 21054 21694 640/640<br>
0033 lcd_restore_009.bin 21694 21702 22342 640/640<br>
0034 lcd_update_000.bin 22342 22350 22990 640/640<br>
0035 lcd_update_001.bin 22990 22998 23638 640/640<br>
0036 lcd_update_002.bin 23638 23646 24286 640/640<br>
0037 lcd_update_003.bin 24286 24294 24934 640/640<br>
0038 lcd_update_004.bin 24934 24942 25582 640/640<br>
0039 lcd_update_005.bin 25582 25590 26230 640/640<br>
0040 lcd_update_006.bin 26230 26238 26878 640/640<br>
0041 lcd_update_007.bin 26878 26886 27526 640/640<br>
0042 lcd_update_008.bin 27526 27534 28174 640/640<br>
0043 lcd_update_009.bin 28174 28182 28822 640/640<br>
0044 vti.bin 28822 28830 3111938 3083108/3083108<br>
0045 vti_2.bin 3111938 3111946 6481750 3369804/3369804<br>
0046 vti_snow.bin 6481750 6481758 8381816 1900058/1900058<br>
0047 Changes.htm 8381816 8381824 8383489 1665/1665<br>
0048 Welcome.htm 8383489 8383497 8385058 1561/1561<br>
0049 BTN_Help.png 8385058 8385066 8388561 3495/3495<br>
0050 vcstyles.css 8388561 8388569 8388953 384/384</p>
<p>{% endhighlight %}</p>
<p>Final sanity check, ensure the file size is correct on disk</p>
<p>{% highlight bash %}
$ python</p>
<blockquote>
<blockquote>
<blockquote>
<p>import os<br>
os.path.getsize("vcstyles.css")<br>
384</p>
</blockquote>
</blockquote>
</blockquote>
<p>$ md5sum *<br>
e20091f333f03e495e52ee731e5d0251 BTN_Help.png<br>
d3d5da69f3eccba4126a5fa710ccfa2f Changes.htm<br>
97a76e68e1de1654f2b1320e4a0b6e84 lcd_backup_000.bin<br>
d4ef509624dae64181b23e0e01187052 lcd_backup_001.bin<br>
355410fc102e05dedd61bf2f0592418c lcd_backup_002.bin<br>
ffdd2d0792fbe02a6273cbe3817a2a5f lcd_backup_003.bin<br>
be983cae6ec12e91e023035460e8a129 lcd_backup_004.bin<br>
0528136dc4588f0681793f33cee3048c lcd_backup_005.bin<br>
be983cae6ec12e91e023035460e8a129 lcd_backup_006.bin<br>
ffdd2d0792fbe02a6273cbe3817a2a5f lcd_backup_007.bin<br>
355410fc102e05dedd61bf2f0592418c lcd_backup_008.bin<br>
d4ef509624dae64181b23e0e01187052 lcd_backup_009.bin<br>
4e4e156b3557c7d37af87392ade02caa lcd_configuring_000.bin<br>
c9c2c001b364f84253b487bd829342d6 lcd_configuring_001.bin<br>
4fecca5121a63263b528bab8e2bd3057 lcd_connected_000.bin<br>
3e05e54772a2344af42f23979bab326a lcd_flashrom_000.bin<br>
7e39a047fe8b8ba2eeea81cb0c63dee0 lcd_flashrom_001.bin<br>
d501c1230ba521369a458c6a17c39c57 lcd_flashrom_002.bin<br>
3a9afc8705ae649f35fd22ed6eadc47d lcd_flashrom_003.bin<br>
9eff0d5ccd3d967c1ed0df75f779193f lcd_flashrom_004.bin<br>
097b4f97ee0f865ed93cb9a36a2842d2 lcd_flashrom_005.bin<br>
9eff0d5ccd3d967c1ed0df75f779193f lcd_flashrom_006.bin<br>
3a9afc8705ae649f35fd22ed6eadc47d lcd_flashrom_007.bin<br>
d501c1230ba521369a458c6a17c39c57 lcd_flashrom_008.bin<br>
7e39a047fe8b8ba2eeea81cb0c63dee0 lcd_flashrom_009.bin<br>
c9f824f89e6e3e919a51cf65566479a0 lcd_restore_000.bin<br>
877b348505e59c682ce7a7d7d658f748 lcd_restore_001.bin<br>
f8d5aff898f14b4a53ebbc29b2fc3d51 lcd_restore_002.bin<br>
9c55fd905edd92ba77e688f6559d53f4 lcd_restore_003.bin<br>
4e7d756df9224208203aa6643fe4d85a lcd_restore_004.bin<br>
12df5f74f4f1b6e7b71fe461cfd8ccf7 lcd_restore_005.bin<br>
4e7d756df9224208203aa6643fe4d85a lcd_restore_006.bin<br>
9c55fd905edd92ba77e688f6559d53f4 lcd_restore_007.bin<br>
f8d5aff898f14b4a53ebbc29b2fc3d51 lcd_restore_008.bin<br>
877b348505e59c682ce7a7d7d658f748 lcd_restore_009.bin<br>
9b0d9a6b8a5e421ce7c95d4c52b32d2c lcd_update_000.bin<br>
45c7c20c28280952bd2e4dad0b8685b6 lcd_update_001.bin<br>
0e7535b55402ff72e438cdf8bb3f5e7c lcd_update_002.bin<br>
32a75edea33fddc4b0acd5a41d7b5eb8 lcd_update_003.bin<br>
e8727a2ba970e0bec88eaf947a848f1d lcd_update_004.bin<br>
7b28e713a7d370e6efbd4a822fb98670 lcd_update_005.bin<br>
e8727a2ba970e0bec88eaf947a848f1d lcd_update_006.bin<br>
32a75edea33fddc4b0acd5a41d7b5eb8 lcd_update_007.bin<br>
0e7535b55402ff72e438cdf8bb3f5e7c lcd_update_008.bin<br>
45c7c20c28280952bd2e4dad0b8685b6 lcd_update_009.bin<br>
0ba15401101f1526327e2fc5edc52822 vcstyles.css<br>
862b0d7c974a7d181d9342fe01b92715 vti_2.bin<br>
9acb16f3b96866163e3a95333cb1508e vti.bin<br>
d759e649c1f01bcf4fdec867bfec7b04 vti_snow.bin<br>
c0b8abe212b623bd58831b3800afe738 Welcome.htm<br>
{% endhighlight %}</p>
<p>Another quick test, and we can see the PNG now loads - woo! For shits and giggles, here it is:</p>
<p><a href="/foxx/foxx.github.io/blob/master/img/postcontent/access-virus-2.png"><img src="/foxx/foxx.github.io/raw/master/img/postcontent/access-virus-2.png" alt="access-virus-2.png" style="max-width:100%;"></a></p>
<p>If anyone is interested, here is the full working code used to extract the firmware chunks:</p>
&lt;script src="<a href="https://gist.github.com/foxx/d4ce9e71c6860650d7af.js&quot;&gt;&lt;/script&gt;">https://gist.github.com/foxx/d4ce9e71c6860650d7af.js"&gt;&lt;/script&gt;</a>
<h3><a id="user-content-analysing-the-firmware" class="anchor" aria-hidden="true" href="#analysing-the-firmware"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Analysing the firmware</h3>
<p>Really the files we are most interested in at vti.bin, vti_2.bin and vti_snow.bin. Obviously, there are 3 different types of Access Virus that this firmware applies to: TI, TI2 and TI Snow. So, lets start digging into those files. Again, we see more IFF headers, which is really strange, but it could mean that these extracted files also have some sort of packing on them.</p>
<p>{% highlight bash %}<br>
$ file vti.bin<br>
vti.bin: IFF data</p>
<p>$ file vti_2.bin<br>
vti_2.bin: IFF data</p>
<p>$ file vti_snow.bin<br>
vti_snow.bin: IFF data</p>
<h1><a id="user-content-vtibin---first-10-bytes" class="anchor" aria-hidden="true" href="#vtibin---first-10-bytes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>VTI.BIN - first 10 bytes</h1>
<p>46 4F 52 4D 00 2F 0B 5C 46 30 30 30 00 00 8C 02 00 = FORM./.\F000.....</p>
<h1><a id="user-content-firmware_bin64---first-10-bytes" class="anchor" aria-hidden="true" href="#firmware_bin64---first-10-bytes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>firmware_bin64 - first 10 bytes</h1>
<p>46 4F 52 4D 00 80 01 51 54 41 42 4C 00 00 03 AE 32 = FORM...QTABL....2</p>
<p>{% endhighlight %}</p>
<p>Here is what happens if we jump ahead 10 bytes (or increment +1 byte each time), then run file against the extracted segment. As you can see, we didn't have any luck.</p>
<p>{% highlight bash %}
$ dd if=vti.bin bs=1 skip=1 &gt; /tmp/1 &amp;&amp; file /tmp/1<br>
/tmp/1: data</p>
<p>$ dd if=vti.bin bs=1 skip=12 &gt; /tmp/1 &amp;&amp; file /tmp/1<br>
/tmp/1: data</p>
<p>-- repeated skip 1~12, same results each time. Binwalk also showed up nothing --<br>
{% endhighlight %}</p>
<p>Okay so, file/binwalk doesn't appear to be finding anything, how about IDA pro? Make sure you set your CPU to "Motorola DSP 5600x: dsp563xx".</p>
<p><a href="/foxx/foxx.github.io/blob/master/img/postcontent/access-virus-3.png"><img src="/foxx/foxx.github.io/raw/master/img/postcontent/access-virus-3.png" alt="access-virus-3.png" style="max-width:100%;"></a></p>
<p>We're going to try loading in 3 different variations of vti.bin. If we offset the file by 5 bytes (in our case, we deleted them manually via hex editor), IDApro seems to now recognise the file! At this point, it doesn't know how to identify the entry point, but it now shows the assembly within the ROM.</p>
<p>{% highlight bash %}
vti.bin = no offset = FAILURE<br>
vti-edit2.bin = offset first 10 bytes = FAILURE<br>
vti-edit.bin = offset first 5 bytes = SUCCESS<br>
{% endhighlight %}</p>
<p><a href="/foxx/foxx.github.io/blob/master/img/postcontent/access-virus-4.png"><img src="/foxx/foxx.github.io/raw/master/img/postcontent/access-virus-4.png" alt="access-virus-4.png" style="max-width:100%;"></a></p>
<p><a href="/foxx/foxx.github.io/blob/master/img/postcontent/access-virus-5.png"><img src="/foxx/foxx.github.io/raw/master/img/postcontent/access-virus-5.png" alt="access-virus-5.png" style="max-width:100%;"></a></p>
<p>I then tried using the following tools:</p>
<ul>
<li>
<p>"DSP56xxx Toolchain v3.6r1" from Tasking. (TASKING_DSP56k_v3.6r4.exe)
<a href="http://www.tasking.com/forms/trial/download-dsp56xxx.shtml" rel="nofollow">http://www.tasking.com/forms/trial/download-dsp56xxx.shtml</a></p>
</li>
<li>
<p>Suite56™ DSP Simulator
<a href="http://styles.freescale.com/lgfiles/updates/Suite56/DSP56300_Tools.exe" rel="nofollow">http://styles.freescale.com/lgfiles/updates/Suite56/DSP56300_Tools.exe</a></p>
</li>
<li>
<p>Freescale DSPS56SIMUM docs
<a href="http://cache.freescale.com/files/dsp/doc/user_guide/DSPS56SIMUM.pdf" rel="nofollow">http://cache.freescale.com/files/dsp/doc/user_guide/DSPS56SIMUM.pdf</a></p>
</li>
<li>
<p>DSP56xxx v3.6 C Cross-Compiler User Guide
<a href="http://www.tasking.com/support/dsp56xxx/m_c56.pdf" rel="nofollow">http://www.tasking.com/support/dsp56xxx/m_c56.pdf</a></p>
</li>
</ul>
<p>All of those tools looked great, and would probably get us digging deeper into the firmware..... However due to my my lack of embedded development / assembly, this was the end of the line for me. Maybe one day I will look back at this once I'm a little more clued up about assembly.. Hopefully this post will be useful to others!</p>
</article>
  </div>

  </div>

  <details class="details-reset details-overlay details-overlay-dark">
    <summary data-hotkey="l" aria-label="Jump to line"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump" aria-label="Jump to line">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-jump-to-line-form Box-body d-flex" action="" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
        <button type="submit" class="btn" data-close-dialog>Go</button>
</form>    </details-dialog>
  </details>


  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div>

    </div>
  </div>

  </div>

        
<div class="footer container-lg px-3" role="contentinfo">
  <div class="position-relative d-flex flex-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap ">
      <li class="mr-3">&copy; 2018 <span title="0.13329s from unicorn-5f67549d7c-d6qfj">GitHub</span>, Inc.</li>
        <li class="mr-3"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3"><a href="https://help.github.com/articles/github-security/" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li class="mr-3"><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon mr-lg-4" href="https://github.com">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap ">
        <li class="mr-3"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
        <li class="mr-3"><a href="https://github.com/pricing" data-ga-click="Footer, go to Pricing, text:Pricing">Pricing</a></li>
      <li class="mr-3"><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3"><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
        <li class="mr-3"><a href="https://blog.github.com" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
    </button>
    You can’t perform that action at this time.
  </div>


    <script crossorigin="anonymous" integrity="sha512-RJ1ufbxsSbKjRCyYvinsPNKvTBvcvvKUvEOJ8g+GjtWI5SuRr+QPBlZcvRDws4H9YwAgdQFcGxfL8UbwEfdI7A==" type="application/javascript" src="https://assets-cdn.github.com/assets/compat-daf14de28fadf1e2bc40d100cb773e2b.js"></script>
    <script crossorigin="anonymous" integrity="sha512-IC5Ai6c7cUBfMx54JUAsIjA7VroipzkizlZ8F6/0efsGGyZStweZV7bX9bxSFL07nUNLfwrKSEysVIijX+CeUw==" type="application/javascript" src="https://assets-cdn.github.com/assets/frameworks-5874e38105ec062c740350eeb96bdd8a.js"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-imV58bqblN4Jn1zdyEEHtkwJ/gp68iGDn64ikbjTW3Lf6CkRScAuj8Qw/yfoqe1Inp8W2CbfjcgqR6nfK+ipXw==" type="application/javascript" src="https://assets-cdn.github.com/assets/github-f06b39ef42ad1ca803ccc93f413c8f6c.js"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner d-none">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
  </div>
  <div class="facebox" id="facebox" style="display:none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
    </button>
  </div>
</div>

  <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark" open>
    <summary aria-haspopup="dialog" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

<div id="hovercard-aria-description" class="sr-only">
  Press h to open a hovercard with more details.
</div>


  </body>
</html>

